<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>VN-Sutra</title>
    <link rel="stylesheet" href="./css/output.css">
    <link id="icon" rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <link rel="manifest" href="./game/manifest.json" crossorigin="use-credentials">
</head>
<body class="overflow-hidden">
    <div id="playground" class=" w-full h-full"></div>

    <audio id="music" src="" loop crossorigin="anonymous"></audio>
    <audio id="sfx" src="" crossorigin="anonymous"></audio>

    <section id="alert-win" class=" absolute top-0 w-full h-full hidden justify-center items-center p-3 bg-slate-950 bg-opacity-70">
        <div id="alert-card" class=" lg:w-1/3 md:w-1/3 w-full border-t-2 p-5 rounded-md bg-slate-900 flex  flex-col justify-between min-h-40 gap-5" style="border-color: orange;">
            <p id="alert-message" class=" w-full">Lorem ipsum dolor sit amet consectetur adipisicing elit. Consequatur aperiam velit quae reprehenderit vero placeat eveniet molestias corporis modi iure tempora amet, explicabo eaque soluta maiores ducimus exercitationem optio id!</p>
            <div id="alert-opts" class=" hidden w-full"></div>
            <div id="alert-input" class="w-full hidden">
                <input type="text" class=" w-full input rounded-full input-bordered">
            </div>
            <div id="alert-btns" class="flex justify-between">
                <button class="btn btn-outline">Cancel</button>
                <button class="btn bg-orange-400 hover:bg-orange-600 border-0 text-slate-900">Proceed</button>
            </div>
        </div>
    </section>

    <section id="loadwin" class="absolute top-0 w-full h-full overflow-hidden bg-slate-900">
        <img id="loadimg" src="" class=" w-full h-full object-cover absolute opacity-70" alt="Poster">
        <div class=" absolute top-0 left-0 w-full h-full flex justify-center items-center">
            <p id="loadtitle" class=" lg:text-8xl md:text-8xl text-7xl drop-shadow-lg"></p>
        </div>
        <div class=" flex items-center absolute bottom-0 left-0 w-full p-3">
            <p id="loadstatus" class=" w-full text-center h-10 lg:text-xl md:text-xl text-lg animate-pulse">Loading...</p>
            <div class=" w-10 aspect-square animate-spin absolute bottom-3 right-3">
                <img id="loadspin" class=" w-full h-full" src="./assets/svgs/spinner.svg" alt="Loading">
            </div>
        </div>
    </section>

    <section id="restartWindow" class="absolute top-0 left-0 w-full h-full bg-slate-900 text-slate-100 hidden justify-center items-center">
        <p class="text-xl">Please open app for best experience!</p>
    </section>
    
    <script type="module">
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/service-worker.js')
            .then(registration => {
                console.log('Service Worker registered with scope:', registration.scope);
                
                registration.onupdatefound = () => {
                    const installingWorker = registration.installing;
                    installingWorker.onstatechange = () => {
                        if (installingWorker.state === 'installed') {
                            if (navigator.serviceWorker.controller) {
                                window.dispatchEvent(new CustomEvent("vnsutra-update"));
                            } else {
                                console.log('Content is cached for offline use.');
                            }
                        }
                    };
                };
            })
            .catch(error => {
                console.log('Service Worker registration failed:', error);
            });
        }
    </script>
    <script src="./vnsutra_modules/jszip.min.js"></script>
    <script src="./vnsutra_modules/konva.js"></script>
    <script src="./vnsutra_modules/mobile/ui.js"></script>
    <script src="./vnsutra_modules/utils.js"></script>
    <script src="./vnsutra_modules/storage-utils.js"></script>
    <script src="./vnsutra_modules/storage.js"></script>
    <script src="./vnsutra_modules/global.js"></script>
    <script src="./vnsutra_modules/stage.js"></script>
    <script src="./vnsutra_modules/ui/utils.js"></script>
    <script src="./vnsutra_modules/ui/actionbar.js"></script>
    <script src="./vnsutra_modules/settings.js"></script>
    <script src="./vnsutra_modules/credits.js"></script>
    <script src="./vnsutra_modules/alert-window.js"></script>
    <script src="./vnsutra_modules/home.js"></script>
    <script src="./vnsutra_modules/game.js"></script>
    <script src="./vnsutra_modules/gameui.js"></script>
    <script type="module" src="./vnsutra_modules/init.js"></script>
    <script src="./vnsutra_modules/loadgame.js"></script>
</body>
</html>